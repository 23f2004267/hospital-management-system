{% extends "root.html" %}
{% block content %}

<h2>Update Patient History</h2>

<div class="box">

<p><b>Patient Name:</b> {{ patient.user_name }}</p>
<p><b>Doctor Name:</b> Dr. {{ doctor.user_name }}</p>
<p><b>Department:</b> {{ department.name }}</p>

<form method="POST" action="{{ url_for('update_history', appointment_id=appointment.id) }}">

    <div class="row">
        <div class="field">
            <label>Visit Type</label>
            <input type="text" name="visit_type">
        </div>

        <div class="field">
            <label>Test Done</label>
            <input type="text" name="test_done">
        </div>
    </div>

    <div class="row">
        <div class="field">
            <label>Diagnosis</label>
            <input type="text" name="diagnosis">
        </div>

        <div class="field">
            <label>Medicines</label>

            <select name="medicine_id" style="width:180px;">
                <option value="">-- Select Medicine --</option>
                {% for med in medicines %}
                <option value="{{ med.id }}">
                    {{ med.name }} ({{ med.intake_time }})
                </option>
                {% endfor %}
            </select>

        </div>
    </div>

    <div class="field">
        <label>Prescription</label>
        <textarea name="prescription"></textarea>
    </div>

    <button class="save-btn">Save</button>
</form>

</div>

<style>
.box {
    width: 70%;
    background: white;
    padding: 25px;
    border-radius: 12px;
    margin: auto;
    border: 2px solid #aaa;
}

.row {
    display: flex;
    gap: 30px;
    margin-bottom: 20px;
}

.field {
    flex: 1;
}

.field input, textarea, select {
    width: 100%;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #555;
}

.save-btn {
    background: #28a745;
    color: white;
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}
.save-btn:hover { background: #1e8e3e; }
</style>

{% endblock %}
