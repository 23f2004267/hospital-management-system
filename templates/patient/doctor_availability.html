{% extends "root.html" %}
{% block title %}Doctor Availability{% endblock %}

{% block content %}

<h2 style="text-align:center; margin-top:15px; font-weight:600;">
    Doctor's Availability
</h2>

<div style="width:80%; margin:auto; margin-top:20px;">

<table width="100%" style="border-collapse:collapse; text-align:center; font-size:15px;">
    <tr style="background:#f5f5f5; height:40px; border-bottom:1px solid #ccc;">
        <th>Date</th>
        <th>08:00 – 12:00 am</th>
        <th>04:00 – 09:00 pm</th>
    </tr>

    {% for date in days %}
    <tr style="border-bottom:1px solid #ddd;">
        <td style="padding:10px;">{{ date }}</td>

        <td style="padding:10px;">
            {% set av = availability.get(date) %}

            {% if av and av.morning == 'available' %}

                {% if booked_morning.get(date) %}
                    <button disabled 
                        style="padding:6px 12px; border:1px solid #aaa; border-radius:4px; background:#eee;">
                        Booked
                    </button>
                {% else %}
                    <form method="POST" action="/book_appointment" style="margin:0;">
                        <input type="hidden" name="doctor_id" value="{{ doctor.id }}">
                        <input type="hidden" name="date" value="{{ date }}">
                        <input type="hidden" name="time" value="morning">
                        <button 
                            style="padding:6px 12px; border:1px solid #888; border-radius:4px; background:white;">
                            Book
                        </button>
                    </form>
                {% endif %}

            {% else %}
                <button disabled 
                    style="padding:6px 12px; border:1px solid #aaa; border-radius:4px; background:#eee;">
                    Not Available
                </button>
            {% endif %}
        </td>

        <td style="padding:10px;">
            {% if av and av.evening == 'available' %}

                {% if booked_evening.get(date) %}
                    <button disabled 
                        style="padding:6px 12px; border:1px solid #aaa; border-radius:4px; background:#eee;">
                        Booked
                    </button>
                {% else %}
                    <form method="POST" action="/book_appointment" style="margin:0;">
                        <input type="hidden" name="doctor_id" value="{{ doctor.id }}">
                        <input type="hidden" name="date" value="{{ date }}">
                        <input type="hidden" name="time" value="evening">
                        <button 
                            style="padding:6px 12px; border:1px solid #888; border-radius:4px; background:white;">
                            Book
                        </button>
                    </form>
                {% endif %}

            {% else %}
                <button disabled 
                    style="padding:6px 12px; border:1px solid #aaa; border-radius:4px; background:#eee;">
                    Not Available
                </button>
            {% endif %}
        </td>

    </tr>
    {% endfor %}
</table>

</div>

{% endblock %}
