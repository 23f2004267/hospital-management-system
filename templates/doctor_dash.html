{% extends "root.html" %}

{% block title %}Doctor Dashboard{% endblock %}

{% block content %}

<h2 style="text-align:center; margin-top:20px;">Doctors' Dashboard</h2>

<div style="
    width:90%; 
    margin:auto; 
    padding:20px;
    border:2px solid #666;
    border-radius:10px;
    background:white;
">

    <div style="display:flex; justify-content:space-between; font-size:18px;">
        <b>Welcome Dr. {{ session['name'] }}</b>
        <a href="/logout" style="text-decoration:none; color:#000;">logout</a>
    </div>

    <h3 style="margin-top:25px;">Upcoming Appointments</h3>

    <table border="1" width="100%" style="border-collapse:collapse; text-align:center;">
        <tr style="background:#eee;">
            <th>Sr No.</th>
            <th>Patient Name</th>
            <th>Patient History</th>
            <th>Actions</th>
        </tr>

        {% if appointments %}
            {% for appt in appointments %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ appt.patient_name }}</td>

                <td>
                    <a href="/doctor/update_history/{{ appt.id }}" 
                       style="background:#5dade2; padding:5px 10px; border-radius:5px; color:white;">
                        update
                    </a>
                </td>

                <td>
                    <a href="/doctor/complete/{{ appt.id }}"
                       style="background:#58d68d; padding:5px 10px; border-radius:5px; color:white;">
                        mark as complete
                    </a>

                    <a href="/doctor/cancel/{{ appt.id }}"
                       style="background:#e74c3c; padding:5px 10px; border-radius:5px; color:white;">
                        cancel
                    </a>
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr><td colspan="4">No appointments</td></tr>
        {% endif %}
    </table>

    <h3 style="margin-top:30px;">Assigned Patients</h3>

    <div style="border:1px solid #aaa; padding:12px; border-radius:10px;">
        {% if patients %}
            {% for p in patients %}
                <div style="padding:10px; border-bottom:1px solid #ddd;">
                    <b>{{ p.user_name }}</b>

                    <a href="{{ url_for('patient_history_doctor', patient_id=p.id) }}"
   style="background: lightblue; padding: 5px 10px; border-radius: 5px; text-decoration:none;">
   View
</a>
                </div>
            {% endfor %}
        {% else %}
            <p>No patients assigned.</p>
        {% endif %}
    </div>

    <div style="text-align:center; margin-top:25px;">
        <a href="/doctor/availability"
           style="padding:8px 20px; background:#82e0aa; border-radius:6px; text-decoration:none;">
            Provide Availability
        </a>
    </div>

</div>

{% endblock %}
